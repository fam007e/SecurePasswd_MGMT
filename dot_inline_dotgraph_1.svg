<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.2 (0)
 -->
<!-- Title: Master Password Security Flow Pages: 1 -->
<svg width="553pt" height="763pt"
 viewBox="0.00 0.00 553.00 763.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 758.74)">
<title>Master Password Security Flow</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-758.74 549,-758.74 549,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_User_Interaction</title>
<polygon fill="none" stroke="black" points="164,-670.24 164,-746.74 438,-746.74 438,-670.24 164,-670.24"/>
<text xml:space="preserve" text-anchor="middle" x="215.88" y="-729.44" font-family="Times,serif" font-size="14.00">User Interaction</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_Salt_Management</title>
<polygon fill="none" stroke="black" points="8,-413.24 8,-651.24 537,-651.24 537,-413.24 8,-413.24"/>
<text xml:space="preserve" text-anchor="middle" x="64.38" y="-633.94" font-family="Times,serif" font-size="14.00">Salt Management</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_Key_Derivation</title>
<polygon fill="none" stroke="black" points="184,-317.74 184,-394.24 484,-394.24 484,-317.74 184,-317.74"/>
<text xml:space="preserve" text-anchor="middle" x="234" y="-376.94" font-family="Times,serif" font-size="14.00">Key Derivation</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_Database_Encryption</title>
<polygon fill="none" stroke="black" points="157,-8 157,-298.74 511,-298.74 511,-8 157,-8"/>
<text xml:space="preserve" text-anchor="middle" x="221.62" y="-281.44" font-family="Times,serif" font-size="14.00">Database Encryption</text>
</g>
<!-- A -->
<g id="node1" class="node">
<title>A</title>
<ellipse fill="none" stroke="black" cx="301" cy="-696.24" rx="129.15" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="301" y="-691.19" font-family="Times,serif" font-size="14.00">User provides Master Password</text>
</g>
<!-- C -->
<g id="node2" class="node">
<title>C</title>
<polygon fill="none" stroke="black" points="301,-618.74 132.84,-600.74 301,-582.74 469.16,-600.74 301,-618.74"/>
<text xml:space="preserve" text-anchor="middle" x="301" y="-595.69" font-family="Times,serif" font-size="14.00">Salt file &#39;vault.db.salt&#39; exists?</text>
</g>
<!-- A&#45;&gt;C -->
<g id="edge6" class="edge">
<title>A&#45;&gt;C</title>
<path fill="none" stroke="black" d="M301,-678.09C301,-664.73 301,-645.89 301,-630.27"/>
<polygon fill="black" stroke="black" points="304.5,-630.61 301,-620.61 297.5,-630.61 304.5,-630.61"/>
</g>
<!-- D -->
<g id="node3" class="node">
<title>D</title>
<ellipse fill="none" stroke="black" cx="451" cy="-512.24" rx="78.48" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="451" y="-507.19" font-family="Times,serif" font-size="14.00">Load existing Salt</text>
</g>
<!-- C&#45;&gt;D -->
<g id="edge1" class="edge">
<title>C&#45;&gt;D</title>
<path fill="none" stroke="black" d="M326.45,-585.06C350.16,-571.39 385.85,-550.81 412.95,-535.18"/>
<polygon fill="black" stroke="black" points="414.65,-538.24 421.56,-530.21 411.15,-532.18 414.65,-538.24"/>
<text xml:space="preserve" text-anchor="middle" x="399.56" y="-551.44" font-family="Times,serif" font-size="14.00">Yes</text>
</g>
<!-- E -->
<g id="node4" class="node">
<title>E</title>
<ellipse fill="none" stroke="black" cx="185" cy="-512.24" rx="169.07" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="185" y="-507.19" font-family="Times,serif" font-size="14.00">Generate new Salt using randombytes_buf</text>
</g>
<!-- C&#45;&gt;E -->
<g id="edge2" class="edge">
<title>C&#45;&gt;E</title>
<path fill="none" stroke="black" d="M280.53,-584.47C263.01,-571.41 237.49,-552.38 217.23,-537.27"/>
<polygon fill="black" stroke="black" points="219.37,-534.5 209.27,-531.33 215.19,-540.12 219.37,-534.5"/>
<text xml:space="preserve" text-anchor="middle" x="261.64" y="-551.44" font-family="Times,serif" font-size="14.00">No</text>
</g>
<!-- F -->
<g id="node6" class="node">
<title>F</title>
<ellipse fill="none" stroke="black" cx="334" cy="-343.74" rx="142.45" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="334" y="-338.69" font-family="Times,serif" font-size="14.00">Derive 32&#45;byte key using Argon2id</text>
</g>
<!-- D&#45;&gt;F -->
<g id="edge7" class="edge">
<title>D&#45;&gt;F</title>
<path fill="none" stroke="black" d="M438.92,-494.05C418.43,-464.88 376.72,-405.53 352.52,-371.09"/>
<polygon fill="black" stroke="black" points="355.67,-369.49 347.06,-363.32 349.95,-373.52 355.67,-369.49"/>
</g>
<!-- S -->
<g id="node5" class="node">
<title>S</title>
<ellipse fill="none" stroke="black" cx="231" cy="-439.24" rx="106.63" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="231" y="-434.19" font-family="Times,serif" font-size="14.00">Save Salt to &#39;vault.db.salt&#39;</text>
</g>
<!-- E&#45;&gt;S -->
<g id="edge3" class="edge">
<title>E&#45;&gt;S</title>
<path fill="none" stroke="black" d="M196.14,-494.05C201.45,-485.85 207.92,-475.86 213.84,-466.72"/>
<polygon fill="black" stroke="black" points="216.64,-468.83 219.14,-458.54 210.77,-465.03 216.64,-468.83"/>
</g>
<!-- S&#45;&gt;F -->
<g id="edge8" class="edge">
<title>S&#45;&gt;F</title>
<path fill="none" stroke="black" d="M249.89,-421.09C265.86,-406.59 288.94,-385.64 306.89,-369.35"/>
<polygon fill="black" stroke="black" points="309.06,-372.11 314.11,-362.8 304.35,-366.93 309.06,-372.11"/>
</g>
<!-- G -->
<g id="node7" class="node">
<title>G</title>
<ellipse fill="none" stroke="black" cx="334" cy="-248.24" rx="169.07" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="334" y="-243.19" font-family="Times,serif" font-size="14.00">Apply derived key to SQLCipher database</text>
</g>
<!-- F&#45;&gt;G -->
<g id="edge4" class="edge">
<title>F&#45;&gt;G</title>
<path fill="none" stroke="black" d="M334,-325.59C334,-312.23 334,-293.39 334,-277.77"/>
<polygon fill="black" stroke="black" points="337.5,-278.11 334,-268.11 330.5,-278.11 337.5,-278.11"/>
</g>
<!-- H -->
<g id="node8" class="node">
<title>H</title>
<ellipse fill="none" stroke="black" cx="334" cy="-104.62" rx="84.62" ry="84.62"/>
<ellipse fill="none" stroke="black" cx="334" cy="-104.62" rx="88.62" ry="88.62"/>
<text xml:space="preserve" text-anchor="middle" x="334" y="-99.57" font-family="Times,serif" font-size="14.00">Encrypted &#39;vault.db&#39;</text>
</g>
<!-- G&#45;&gt;H -->
<g id="edge5" class="edge">
<title>G&#45;&gt;H</title>
<path fill="none" stroke="black" d="M334,-229.87C334,-222.92 334,-214.32 334,-204.92"/>
<polygon fill="black" stroke="black" points="337.5,-205.07 334,-195.07 330.5,-205.07 337.5,-205.07"/>
</g>
</g>
</svg>
